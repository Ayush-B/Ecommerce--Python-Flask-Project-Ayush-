{% extends "layouts/base.html" %}

{% block content %}

<h2 class="ui header">Your Orders</h2>

{% if orders|length == 0 %}
<div class="ui placeholder segment" style="margin-top: 2em;">
    <div class="ui icon header">
        <i class="shopping bag outline icon"></i>
        You have no orders yet.
    </div>
    <a href="{{ url_for('shop.home') }}" class="ui primary button">
        Start Shopping
    </a>
</div>
{% else %}

<table class="ui celled table">
    <thead>
        <tr>
            <th>Order</th>
            <th>Status</th>
            <th>Date</th>
            <th>Total</th>
            <th class="collapsing"></th>
        </tr>
    </thead>
    <tbody>
        {% for order in orders %}
        <tr>
            <td>
                <a href="{{ url_for('orders.order_detail', order_id=order.id) }}">
                    #{{ order.id }}
                </a>
            </td>
            <td>
                <span class="ui small label">{{ order.status }}</span>
            </td>
            <td>
                {% if order.placed_at %}
                    {{ order.placed_at.strftime("%Y-%m-%d %H:%M") }}
                {% else %}
                    Unknown
                {% endif %}
            </td>
            <td>
                ${{ "%.2f"|format(order.total_cents / 100) }}
            </td>
            <td class="right aligned">
                <a href="{{ url_for('orders.order_detail', order_id=order.id) }}"
                   class="ui button small">
                    View
                </a>

                {% if order.status == "pending" %}
                <form action="{{ url_for('orders.cancel_order', order_id=order.id) }}"
                      method="post"
                      style="display:inline;">
                    <button class="ui red button small">Cancel</button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div class="ui pagination menu">
    {% if page > 1 %}
    <a class="item" href="{{ url_for('orders.list_orders', page=page-1) }}">Previous</a>
    {% endif %}

    {% for p in range(1, pages+1) %}
    <a class="item {% if p == page %}active{% endif %}"
       href="{{ url_for('orders.list_orders', page=p) }}">
        {{ p }}
    </a>
    {% endfor %}

    {% if page < pages %}
    <a class="item" href="{{ url_for('orders.list_orders', page=page+1) }}">Next</a>
    {% endif %}
</div>

{% endif %}

{% endblock %}
